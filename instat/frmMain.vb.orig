' Instat-R
' Copyright (C) 2015
'
' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.
'
' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.
'
' You should have received a copy of the GNU General Public License k
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Imports RDotNet
Imports System.IO
Public Class frmMain

    Public clsRInterface As New RInterface

    Private Sub frmMain_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        frmEditor.MdiParent = Me
        frmCommand.MdiParent = Me
        'frmGraphics.MdiParent = Me
        frmLog.MdiParent = Me
        frmScript.MdiParent = Me
        frmLog.MdiParent = Me
        Me.LayoutMdi(MdiLayout.ArrangeIcons)

        'frmCommand.Dock = DockStyle.Fill
        frmEditor.Dock = DockStyle.Left
        frmEditor.Dock = DockStyle.Fill
        frmCommand.Dock = DockStyle.Right
        frmLog.Dock = DockStyle.Right
        frmLog.Dock = DockStyle.Bottom

        frmCommand.Show()
        frmEditor.Show()
        clsRInterface.SetLog(frmLog.txtLog)
        clsRInterface.SetOutput(frmCommand.txtCommand)

    End Sub

    Private Sub ImportASCIIToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles mnuFIleIEASCII.Click

        Dim dlgOpen As New OpenFileDialog
        Dim strExtension As String
        Dim strHolder As String
        Dim dataset As DataFrame

        'For importing files into the instat'
        'start the open file dialog
        dlgOpen.Filter = "Comma Separated (*.csv)|*.csv|Excel 2-5/95/97 (*.xls)|*.xls|All Files (*.*)|*.*"
        dlgOpen.Title = "Import"
        If dlgOpen.ShowDialog() = DialogResult.OK Then
            'checks if the file name is not blank'
            If dlgOpen.FileName <> "" Then
                strExtension = Path.GetExtension(dlgOpen.FileName)
                strHolder = Replace(dlgOpen.FileName, "\", "/")
                clsRInterface.LoadData(strExtension, strHolder)
            Else
                MsgBox("Must have a file name!", vbInformation, "Message from Instat")
            End If
        Else
            MsgBox("No File was selected!", vbInformation, "Message From Instat")
        End If

        dataset = clsRInterface.GetData("data")
        frmEditor.UpdateSheet()
    End Sub



    Private Sub DescribeToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles DescribeToolStripMenuItem.Click
<<<<<<< HEAD
        'dlgDescriptiveStatistics.Show()
    End Sub

=======
        dlgDescriptiveStatistics.Show()
    End Sub
    Private Sub BoxplotToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles BoxplotToolStripMenuItem.Click
        frmBoxPlot1.Show()
    End Sub

>>>>>>> 15d08ed9d4d9926762ed0d891d4c122cf58450fe
    Private Sub mnuFileOpenWorksheet_Click(sender As Object, e As EventArgs) Handles mnuFileOpenWorksheet.Click

    End Sub

    Private Sub CutCtrlXToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles mnuEditCut.Click

    End Sub

    Private Sub mnuBar_ItemClicked(sender As Object, e As ToolStripItemClickedEventArgs) Handles mnuBar.ItemClicked

    End Sub

    Private Sub mnuManageRegular_Click(sender As Object, e As EventArgs) Handles mnuManageRegular.Click
        dlgRegularSequence.Show()
    End Sub

    Private Sub mnuFileNewWorksheet_Click(sender As Object, e As EventArgs) Handles mnuFileNewWorksheet.Click
        frmEditor.NewSheet()
    End Sub
End Class